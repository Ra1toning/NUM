# Постфикс буюу Дагаварт (postfix) тэмдэглэгээ
![GitHub Classroom Workflow](../../workflows/GitHub%20Classroom%20Workflow/badge.svg?branch=main) ![Points badge](../../blob/badges/.github/badges/points.svg)

Уг хэлбэрийн тэгшитгэл нь үйлдэл нь оферандынхаа хойноо байдаг хэлбэрийг тэгшитгэл юм. Жишээ нь
```
3 4 + 
```
Уг хэлбэрийн тэгшитгэлийг бодох үйлдлийн дараалал гэж байхгүй (хаалт байхгүй, үржих хуваахыг түрүүлж хийхгүй). Урдаас нь эхлэн таарсан үйлдлээ шууд хийнэ. Жишээ нь 
```
3 - 2 * (22 - 4 + 8) + 2
```
инфикс тэгшитгэл 
```
3 2 22 4 - 8 + * - 2 +
```
гэж постфиксээр бичигдэх юм.

## Хөрвүүлэх аргачлал
Үйлдлүүдэд зэрэглэл тогтооно.
  1. `+`, `-`
  2. `*`, `/`, `%`
гэж үзье. 

Стак ашиглан дараах дүрмийн дагуу хөрвүүлэлтийг хийнэ. Постфикс тэгшитгэлийг жагсаалтад хадгална гэж үзье.
  1. Оферанд (үйлдэл хийгдэх тоо) бол шууд жагсаалтын төгсгөлд оруулна.
  2. '(' бол стакт оруулна.
  3. ')' бол стакт '(' хаалт хүртэлх бүгдийг гаргаж жагсаалтын төгсгөлд оруулна. Мөн '(' хаалтыг стакаас гаргаад хаяна. Жагсаалтад оруулахгүй.
  4. Уг тэмдэгт оператор (+, -, *, /, %) үед энэ дүрмээр оруулна.
     1. Стак хоосон эсвэл '(' хаалт хамгийн дээр байгаа эсвэл стакын хамгийн дээд талд байгаа оператор, уг оператороос эрс бага зэрэглэлтэй бол стакт операторыг оруулна. 
     2. Үгүй бол эрс бага зэрэглэлтэй оператор стакын хамгийн дээд талд үлдэх эсвэл стак хоосон эсвэл нээх хаалт стакын дээд талд үлдтэл стакаас операторуудыг гаргаж жагсаалтын төгсгөлд оруулна. Дараа нь уг операторыг стакт оруулна.
  5. Тэгшитгэлийн төгсгөлд хүрсэн бол стакаас бүгдийг гарган жагсаалтын төгсгөлд оруулна.  

Жишээ нь `3 - 2 * (22 - 4 + 8) + 2` тэгшитгэлийн хувьд
```
1. 3 => 1-р дүрмээр жагсаалтын төгсгөлд орно.
   стак: хоосон
   жагсаалт: 3
2. - => 4.1 дүрмээр стакт оруулна.
   стак: -
   жагсаалт: 3
3. 2 => 1-р дүрмээр жагсаалтын төгсгөлд орно.
   стак: -
   жагсаалт: 3 2
4. * => 4.1 дүрмээр стакт оруулна.
   стак: - *
   жагсаалт: 3 2
5. ( => 2-р дүрмээр стакт оруулна.
   стак: - * (
   жагсаалт: 3 2
6. 22 => 1-р дүрмээр жагсаалтын төгсгөлд орно.
   стак: - * (
   жагсаалт: 3 2 22
7. - => 4.1 дүрмээр стакт оруулна.
   стак: - * ( -
   жагсаалт: 3 2 22
8. 4 => 1-р дүрмээр жагсаалтын төгсгөлд орно.
   стак: - * ( -
   жагсаалт: 3 2 22 4
9. + => 4.2-р дүрмээр стакаас үйлдлүүдийг гаргаж, оруулна.
   стак: - * ( +
   жагсаалт: 3 2 22 4 -
10. 8 => 1-р дүрмээр жагсаалтын төгсгөлд орно.
   стак: - * ( + 
   жагсаалт: 3 2 22 4 - 8
11. ) => 3 дүрмээр стакаас нээх хаалт хүртэлхийг гаргана.
   стак: - *
   жагсаалт: 3 2 22 4 - 8 +
12. + => 4.1 дүрмээр стакаас үйлдлүүдийг гаргаж, оруулна.
   стак: +
   жагсаалт: 3 2 22 4 - 8 + * -
13. 2 => 1-р дүрмээр жагсаалтын төгсгөлд орно.
   стак: +
   жагсаалт: 3 2 22 4 - 8 + * - 2
14. 5-р дүрмээр бүгдийг стакаас гаргаж хэвлэнэ.
   стак: 
   жагсаалт: 3 2 22 4 - 8 + * - 2 +
```

## Хэрэгжүүлэх заавар

`postfix.c` файл доторх кодыг гүйцээ. Ингэхдээ өөрсдийн бичсэн динамик стак, жагсаалт бүтцийн кодыг ашиглана. Уг програм нь оруулсан тэгшитгэлийг постфикс тэгшитгэлд хөрвүүлээд. Үр дүнг нь бодож гаргана.

### Тэмдэгтэн цуваанаас оператор, операндыг салгах

Тэгшитгэлийг хадгалах тэмдэгтэн цуваанаас тоо, тэмдэгтүүдийг ялган хөрвүүлэх хэрэгтэй. Ингэхийн тулд
```C
void tokenize(const char s[], List *p_list);
```
функцийг ашиглана. Уг функц нь `s` хадгалагдсан тэгшитгэлээс оператор, операндыг салган `p_list` жагсаалтад хадгална. `p_list` жагсаалт нь `Token` төрөл хадгалах жагсаалт байна. `Token` төрөл нь оператор, операндыг аль алийг хадгалах боломжтой байна.

| Token |
|:-----:|
| flag  |
| val   |
| op    |

  * **flag**: 1 бол тооны буюу операндын мэдээлэл хадгалах ба `val` талбарт хадгалагдана.  
              0 бол тэмдэгт буюу операторын мэдээлэл хадгалах ба `op` талбарт хадгалагдана.
  * **val**: Бүхэл тоо хадгална. `flag = 1` бол энэ талбар утгатай мэдээлэл хадгална.
  * **op**: Тэмдэгт хадгална. `flag = 0` бол энэ талбар утгатай мэдээлэл хадгална.

`tokenize` функцийг дуудсаны дараа `p_list` жагсаалт тэгшитгэлийн оператор, операндуудыг хадгална.
Жишээ нь `3*(2+7)` тэгшитгэлийн хувьд жагсаалтын элементүүд нь
```
+----------+    +---------+    +----------+    +----------+    +----------+    +----------+   +-----------+
| Token    |    | Token   |    | Token    |    | Token    |    | Token    |    | Token    |   | Token     |
+----------+    +---------+    +----------+    +----------+    +----------+    +----------+   +-----------+
| flag = 1 |    | flag = 0|    | flag = 0 |    | flag = 1 |    | flag = 0 |    | flag = 1 |   | flag = 0  |
+----------+--->+---------+--->+----------+--->+----------+--->+----------+--->+----------+-->+-----------+
| val = 3  |    | val = ? |    | val = ?  |    | val = 2  |    | val = ?  |    | val = 7  |   | val = ?   |
+----------+    +---------+    +----------+    +----------+    +----------+    +----------+   +-----------+
|  op = ?  |    | op = *  |    | op = (   |    | op = ?   |    | op = +   |    | op = ?   |   | op = )    |
+----------+    +---------+    +----------+    +----------+    +----------+    +----------+   +-----------+
```
байна.

Токен төрлийг дараах бүтцэд хадгална.
```C
struct Token {
	int flag;    /*
				  flag = 1 бол уг объект тооны мэдээлэл val-д хадгална
				  flag = 0 бол уг объект op-д тэмдэгт хадгална
				 */
	int val;
	char op;
};
```

### Стак бүтэц

Уг даалгаварт стак хоёр янзаар ашиглагдана.
  * Инфикс тэмдэглэгээг постфикс тэмдэглэгээнд хөрвүүлэхэд стак хэрэглэнэ.
  * Постфикс тэмдэглэгээнд байгаа тэгшитгэлийг бодож хариуг гаргахад бас хэрэглэнэ.

Стакт тэмдэгт болон бүхэл тоог аль алийг нь хадгална. Гэхдээ тэмдэгт гэдэг бол 0-256 хүртэлх утга авдаг тоо байдаг тул ганцхан бүхэл тоо хадгалах л стак байхад хангалттай.
```C
struct Elm {
        int x;
        struct Elm *next;
};
typedef struct Elm Elm;

// Stack 
struct Stack {
        Elm *top;
        int len;
};
typedef struct Stack Stack;

void s_push(Stack *, int );
void s_pop(Stack *);
void s_print(Stack *);
```
Өмнө хэрэгжүүлсэн динамик стакаа хуулан `stack.c` файлд хэрэгжүүлнэ.

### Жагсаалт бүтэц

Та өөрийн өмнө бичсэн динамик жагсаалтыг `Token` төрөл хадгалахаар өөрчилж ашиглана уу. Ингэхэд дараах өөрчлөлтүүд хийгдэнэ.
```C
struct TokenElm {
        Token x;
        struct TokenElm *next;
};
typedef struct TokenElm TokenElm;

// List бүтэц
struct List {
        TokenElm *head;
        TokenElm *tail;
        int len;
};
typedef struct List List;
```

Жагсаалтын элемент `Token` төрөл хадгална. `Elm` бүтцийг стакын `Elm` бүтэцтэй давхардуулахгүйн тулд `TokenElm` гэж нэрлэсэн. Гишүүн функцүүд нь дараах функцүүд байна.
```C
void l_push_back(List *, Token);
void l_push_front(List *, Token);
void l_insert(List *, Token, int);
void l_pop_front(List *);
void l_pop_back(List *);
void l_erase(List *, int);
void l_print(List *);
```

### Аль хэдийн хэрэгжүүлэгдсэн функцүүд

Дараах функцүүд аль хэдийн хэрэгжүүлэгдсэн.

  * Хоосон зайг шалгах функц: Дамжуулсан тэмдэгт хоосон зай бол 1 үгүй бол 0-ыг буцаана.
    ```C
    int is_space(int x);
    ```
  * Тэмдэгтэн цувааг бүхэл тоонд хөрвүүлэх функц: `s` тэмдэгтэн цуваанд цифрүүд хадгалагдсан гэж үзэн бүхэл тоонд хөрвүүлэн бүхэл тоог буцаана. Хэрэв цифрээс өөр мэдээлэл хадгалагдсан бол буруу үр дүн буцаана.
    ```C
    int convert_to_int(const char s[])
    ```
  * Опетатор, операндад задлах: `s` тэмдэгтэн цуваанд хадгалагдсан тэгшитгэлийг оператор, операндаар нь салган `p_list` жагсаалтад хадгална.
    ```C
    void tokenize(const char s[], List *p_list);
    ```

### Хэрэгжүүлэх функцүүд
  * Инфикс тэгшитгэлийг постфикст хөрвүүлэх: `p_token` жагсаалтад хадгалагдсан байгаа оператор, операндыг мэдээллийг постфикст оператор, операндын жагсаалт болгон `p_post` жагсаалтад хадгална.
    ```C
    void convert_to_postfix(List *p_token, List *p_post);
    ```
  * Үр дүн бодох: `p_post` хаяган хувьсагчийн зааж байгаа постфикс хэлбэрээр хадгалагдсан оператор, операндын мэдээллийг авч үйлдлүүдийг хийн бодож гарсан хариуг буцаана.
    ```C
    int solve(List *p_post);
    ```
  * Хэвлэн функц: `p_list` жагсаалтад байгаа операнд, операторын жагсаалтыг хэвлэнэ. Хэвлэхдээ ямар ч хоосон зайгүй хэвлэнэ. Жишээ нь `3*(2+7)` хэвлээд ард хамгийн төгсгөлд шинэ мөр хэвлэх ёстой. `Token` төрлийн `flag = 1` бол бүхэл тоо, `flag = 0` бол тэмдэгт хэвлэхийг санаарай.
    ```C
    void l_print(List *);
    ```
