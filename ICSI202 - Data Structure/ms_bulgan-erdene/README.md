# Нилүүлэн эрэмбэлэлт (Mergesort)
![GitHub Classroom Workflow](../../workflows/GitHub%20Classroom%20Workflow/badge.svg?branch=main) ![Points badge](../../blob/badges/.github/badges/points.svg)

Лекцээр үзсэний дагуу нийлүүлэн эрэмбэлэх аргыг хэрэгжүүл.

## Даалгаврыг хийх заавар

Уг даалгавраар оюутны мэдээллийг нийлүүлэн эрэмбэлэх арга ашиглан эрэмбэлнэ. Оюутан бүр дараах гишүүн өгөгдөлтэй.
```C
struct Student {
        char name[20];  // Нэр
        int age;        // Нас
        float gpa;      // Дүнгийн голч
};
```
Нийлүүлэн эрэмбэлэх алгоритм тогтвортой эрэмбэ үүсгэдэг. Энэ нь тэнцүү утгуудын хувьд өмнөх эрэмбээ хадгална гэсэн үг юм.

Уг даалгаврыг шалгахдаа эхлээд нэрээр, дараа нь насаар, дараа нь дүнгээр эрэмбэлж шалгана. Ингэснээр дүн тэнцүү оюутнууд насаараа эрэмбэлэгдэх ба нас нь тэнцүү бол нэрээрээ эрэмбэлэгдсэн дараалал үүсгэнэ.

1,000,000 ширхэг оюутны мэдээллийг эрэмбэлэх бөгөөд алгоритм <span style="color:red">2 секундэд</span>  амжиж хариугаа гаргах ёстой.

`myinput.txt`,  `myinput2.txt` файлуудаар өөрийн кодыг шалгаж үзээрэй.  

### Шаардагдах мэдлэг
  1. Си хэлний бүтэц (struct).
  2. Хүснэгт.
  3. Функцийн хаяг заагч (function pointer).

Уг даалгавар дээр програмчлалын мэргэжлийн техникүүдийн нэг болох функцийг хаягаар дамжуулан ашиглана.

### Хэрэгжүүлэх функцүүд

  * Нэрээр жиших функц: a, b хаяганд хадгалагдсан сурагчдыг нэрээр жиших функц. `a->name`, `b->name`-ээс их бол -1, тэнцүү бол 0, бага бол 1-ийг буцаана.
    ```C  
    int nereer(const Student *a, const Student *b);
    ```
  * Насаар жиших функц: a, b хаяганд хадгалагдсан сурагчдыг насаар нь жиших функц. `a->age`, `b->age`-аас их бол -1, тэнцүү бол 0, бага бол 1-ийг буцаана.
    ```C
    int nasaar(const Student *a, const Student *b);
    ```
  * Голчоор жиших функц: a, b хаяганд хадгалагдсан сурагчдыг голчоор  нь жиших функц. `a->gpa`, `b->gpa`-оос их бол -1, тэнцүү бол 0, бага бол 1-ийг буцаана.  
    ```C
    int golchoor(const Student *a, const Student *b);
    ```
  * Оруулан эрэмбэлэх функц: Уг функц нь оруулан эрэмбэлэх аргаар эрэмбэлэхдээ `a` хүснэгтийн `[lo; hi]` завсрыг л зөвхөн эрэмбэлнэ. Жиших хоёр оюутныг жишихдээ less функцэн заагчид хадгалагдсан функцийг ашиглан хийнэ. Тэнцүү утгуудын хувьд орж ирсэн дарааллаар нь эрэмбэлнэ.
    ```C
    void insertion_sort(Student a[], 
                        int lo, int hi,
                        int (*less)(const Student *, const Student *));
    ```

  * Нийлүүлсэн эрэмбэлэх аргын mege үйлдэл: Уг функц нь `a` хүснэгтэд `[lo; mid]`, `[mid+1; hi]` завсарт  эрэмбэлэгдсэн хүснэгтийг нийлүүлэн `[lo; hi]` завсарт эрэмбэлэгдсэн хүснэгт болгоно. `aux` хүснэгт нь нэмэлтээр ашиглах хүснэгт. Оюутнуудыг хооронд нь жишихдээ `less` функцэн заагчийг ашиглана.
    ```C
    void merge(Student a[],
               Student aux[],
               int lo,
               int mid,
               int hi,
               int (*less)(const Student *, const Student *));
    ```
  * Нийлүүлсэн эрэмбэлэх функц: Уг функц нь merge, insertion_sort функцүүдийг дуудан ашиглаж `a` хүснэгтийг нийлүүлэн эрэмбэлэх аргаар эрэмбэлнэ. Ингэхдээ `hi - lo <= CUTOFF` бол оруулан эрэмбэлэх аргыг хэрэглэнэ. Жиших үйлдлийг less функцэн заагчийг хадгалсан функцийг ашиглан хийнэ.
    ```C
    void mergesort(Student a[],
                   Student aux[],
                   int lo,
                   int hi,
                   int (*less)(const Student *, const Student *));
    ```

### Жишээ тайлбар

`CUT_OFF = 0` үед бид нар үргэлж нийлүүлэн эрэмбэлэх аргыг ашиглаж эрэмбэлнэ. Дараах `myinput.txt` файлын хувьд
```
Amir 19 90
Zundui 18 95
Baasan 20 60
Uchral 21 100
Manlai 22 100
Onon 19 90
```
Эхлээд `mergesort(a, 0, n - 1, nereer)` гэж дуудан нэрээр эрэмбэлсэн үед
```
90.0	19	Amir
60.0	20	Baasan
100.0	22	Manlai
90.0	19	Onon
100.0	21	Uchral
95.0	18	Zundui
```
Дараа нь `mergesort(a, 0, n - 1, nasaar)` гэж дуудан насаар эрэмбэлсэн үед
```
95.0	18	Zundui
90.0	19	Amir
90.0	19	Onon
60.0	20	Baasan
100.0	21	Uchral
100.0	22	Manlai
```
Дараа нь `mergesort(a, 0, n - 1, golchoor)` гэж дуудан голчоор эрэмбэлсэн үед
```
60.0	20	Baasan
90.0	19	Amir
90.0	19	Onon
95.0	18	Zundui
100.0	21	Uchral
100.0	22	Manlai
```
Хамгийн сүүлийн эрэмбэлэгдсэн жагсаалт бол голч тэнцүү үед насаар, нас тэнцүү үед нэрээр эрэмбэлсэн жагсаалт байна.
